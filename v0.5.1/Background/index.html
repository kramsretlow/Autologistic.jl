<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Background · Autologistic.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Autologistic.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Background</a><ul class="internal"><li><a class="tocitem" href="#The-Autologistic-(AL)-Model"><span>The Autologistic (AL) Model</span></a></li><li><a class="tocitem" href="#The-Autologistic-Regression-(ALR)-Model"><span>The Autologistic Regression (ALR) Model</span></a></li><li><a class="tocitem" href="#The-Symmetric-Model-and-Logistic-Regression"><span>The Symmetric Model and Logistic Regression</span></a></li></ul></li><li><a class="tocitem" href="../Design/">Design of the Package</a></li><li><a class="tocitem" href="../BasicUsage/">Basic Usage</a></li><li><a class="tocitem" href="../Examples/">Examples</a></li><li><a class="tocitem" href="../api/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Background</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Background</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/kramsretlow/Autologistic.jl/blob/master/docs/src/Background.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Background"><a class="docs-heading-anchor" href="#Background">Background</a><a id="Background-1"></a><a class="docs-heading-anchor-permalink" href="#Background" title="Permalink"></a></h1><p>This section provides a brief overview of the autologistic model, to establish some conventions and terminology that will help you to make appropriate use of <code>Autologistic.jl</code>.</p><p>The package is concerned with the analysis of dichotomous data: categorical observations that can take two possible values (low or high, alive or dead, present or absent, etc.).   It is common to refer to such data as binary, and to use numeric values 0 and 1 to represent the two states. We do not have to use 0 and 1, however: any other pair of numbers could be used instead. This might seem like a small detail, but for autologistic regression models, the choice of numeric coding is very important. The pair of values used to represent the two states is called the <strong>coding</strong>.</p><div class="admonition is-info"><header class="admonition-header">Important Fact 1</header><div class="admonition-body"><p>For ALR models, two otherwise-identical models that differ only in their coding will generally <strong>not</strong> be equivalent probability models.  Changing the coding fundamentally changes the model. For <a href="https://doi.org/10.3389/fams.2017.00024">a variety of reasons</a>, the <span>$(-1,1)$</span> coding is strongly recommended, and is used by default.</p></div></div><p>When responses are independent (conditional on the covariates), logistic regression is the most common model. For cases where the independence assumption might not hold—responses are correlated, even after including covariate effects—autologistic models are a useful option.  They revert to logistic regression models when their association parameters are set to zero.</p><h2 id="The-Autologistic-(AL)-Model"><a class="docs-heading-anchor" href="#The-Autologistic-(AL)-Model">The Autologistic (AL) Model</a><a id="The-Autologistic-(AL)-Model-1"></a><a class="docs-heading-anchor-permalink" href="#The-Autologistic-(AL)-Model" title="Permalink"></a></h2><p>Let <span>$\mathbf{Y}$</span> be a vector of <span>$n$</span> dichotomous random variables, expressed using any chosen coding.  The AL model is a probability model for the joint distribution of the variables. Under the AL model, the joint probability mass function (PMF) of the random vector is:</p><p class="math-container">\[\Pr(\mathbf{Y}=\mathbf{y}) \propto \exp\left(\mathbf{y}^T\boldsymbol{\alpha} -
\mathbf{y}^T\boldsymbol{\Lambda}\boldsymbol{\mu} +
\frac{1}{2}\mathbf{y}^T\boldsymbol{\Lambda}\mathbf{y}\right)\]</p><p>The model is only specified up to a proportionality constant.  The proportionality constant (sometimes called the &quot;partition function&quot;) is intractable for even moderately large <span>$n$</span>: evaluating it requires computing the right hand side of the above equation for <span>$2^n$</span> possible configurations of the dichotomous responses.</p><p>Inside the exponential above, there are three terms:</p><ul><li>The first term is the <strong>unary</strong> term, and <span>$\mathbf{\alpha}$</span> is called the <strong>unary parameter</strong>.  It summarizes each variable&#39;s endogenous tendency to take the &quot;high&quot; state. Larger positive <span>$\alpha_i$</span> values make random variable <span>$Y_i$</span> more likely to take the &quot;high&quot; value.  Note that in practical models, <span>$\mathbf{\alpha}$</span> could be expressed in terms of some other parameters.</li><li>The second term is an optional <strong>centering</strong> term, and the value <span>$\mu_i$</span> is called the centering adjustment for variable <span>$i$</span>.  The package includes different options for centering, in the <a href="../api/#Autologistic.CenteringKinds"><code>CenteringKinds</code></a> enumeration.  Setting centering to <code>none</code> will set the centering adjustment to zero; setting centering to <code>expectation</code> will use the centering adjustment of the &quot;centered autologistic model&quot; that has appeared in the literature (e.g. <a href="https://link.springer.com/article/10.1198/jabes.2009.07032">here</a> and <a href="https://doi.org/10.1002/env.1102">here</a>).</li></ul><div class="admonition is-info"><header class="admonition-header">Important Fact 2</header><div class="admonition-body"><p>Just as with coding, changing an un-centered model to a centered one is not a minor change.  It produces a different probability model entirely.  There is evidence that <a href="https://doi.org/10.3389/fams.2017.00024">centering has drawbacks</a>, so the uncentered model is used by default.</p></div></div><ul><li>The third term is the <strong>pairwise</strong> term, which handles the association between the random variables.  Parameter <span>$\boldsymbol{\Lambda}$</span> is a symmetric matrix.  If it has a nonzero entry at position <span>$(i,j)$</span>, then variables <span>$i$</span> and <span>$j$</span> share an edge in the graph associated with the model, and the value of the entry controls the strength of association between those two variables. <span>$\boldsymbol{\Lambda}$</span> can be parametrized in different ways.  The simplest and most common option is to let <span>$\boldsymbol{\Lambda} = \lambda\mathbf{A}$</span>, where <span>$\mathbf{A}$</span> is the adjacency matrix of the graph.  This &quot;simple pairwise&quot; option has only a single association parameter, <span>$\lambda$</span>.</li></ul><p>The autogologistic model is a <a href="https://en.wikipedia.org/wiki/Graphical_model">probabilistic graphical model</a>, more specifically a <a href="https://en.wikipedia.org/wiki/Markov_random_field">Markov random field</a>, meaning it has an undirected graph that encodes conditional probability relationships among the variables. <code>Autologistic.jl</code> uses <code>Graphs.jl</code> to represent the graph.</p><h2 id="The-Autologistic-Regression-(ALR)-Model"><a class="docs-heading-anchor" href="#The-Autologistic-Regression-(ALR)-Model">The Autologistic Regression (ALR) Model</a><a id="The-Autologistic-Regression-(ALR)-Model-1"></a><a class="docs-heading-anchor-permalink" href="#The-Autologistic-Regression-(ALR)-Model" title="Permalink"></a></h2><p>The AL model becomes an ALR model when the unary parameter is written as a linear predictor:</p><p class="math-container">\[\Pr(\mathbf{Y}=\mathbf{y}) \propto \exp\left(\mathbf{y}^T\mathbf{X}\boldsymbol{\beta} -
\mathbf{y}^T\boldsymbol{\Lambda}\boldsymbol{\mu} +
\frac{1}{2}\mathbf{y}^T\boldsymbol{\Lambda}\mathbf{y}\right)\]</p><p>where <span>$\mathbf{X}$</span> is a matrix of predictors/covariates, and <span>$\boldsymbol{\beta}$</span> is a vector of regression coefficients.</p><p>Note that because the responses are correlated, we treat each vector <span>$\mathbf{y}$</span> as a single observation, consisting of a set of &quot;variables,&quot; &quot;vertices,&quot; or &quot;responses.&quot; If the number of variables is large enough, the model can be fit with only one observation. With more than one observation, we can write the data as <span>$(\mathbf{y}_1, \mathbf{X}_1), \ldots (\mathbf{y}_m, \mathbf{X}_m)$</span>. Each observation is a vector with its own matrix of predictor values.  </p><h2 id="The-Symmetric-Model-and-Logistic-Regression"><a class="docs-heading-anchor" href="#The-Symmetric-Model-and-Logistic-Regression">The Symmetric Model and Logistic Regression</a><a id="The-Symmetric-Model-and-Logistic-Regression-1"></a><a class="docs-heading-anchor-permalink" href="#The-Symmetric-Model-and-Logistic-Regression" title="Permalink"></a></h2><p>Autologistic models can be expressed in a conditional log odds form.  Let <span>$\pi_i$</span> be the probability that variable <span>$i$</span> takes the high level, conditional on the values of all of its neighbors. Then the AL model implies</p><p class="math-container">\[\text{logit}(\pi_i) = (h-\ell)(\alpha_i + \sum_{j\sim i}\lambda_{ij}(y_j - \mu_j)),\]</p><p>where <span>$(\ell, h)$</span> is the coding, <span>$\lambda_{ij}$</span> is the <span>$(i,j)$</span>th element of <span>$\Lambda$</span>, and <span>$j\sim i$</span> means &quot;all variables that are neighbors of <span>$i$</span>&quot;.</p><p>The conditional form illustrates the link between ALR models and logistic regression.  In the ALR model, <span>$\alpha_i = \mathbf{X}_i\boldsymbol{\beta}$</span>.  If all <span>$\lambda_{ij}=0$</span> and the coding is <span>$(0,1)$</span>, the model becomes a logistic regression model.</p><p>If we fit an ALR model to a data set, it is natural to wonder how the regression coefficients compare to the logistic regression model, which assumes independence. Unfortunately, the coefficients of the preferred &quot;symmetric&quot; ALR model are not immediately comparable to logistic regression coefficients, because it uses <span>$(-1,1)$</span> coding.  It is not hard to make the model comparable, however.</p><div class="admonition is-info"><header class="admonition-header">The symmetric ALR model with (0,1) coding</header><div class="admonition-body"><p>The symmetric ALR model with <span>$(-1, 1)$</span> coding is equivalent to a model with <span>$(0,1)$</span> coding and a constant centering adjustment of 0.5.</p><p>If the original symmetric model has coefficients <span>$(β, Λ)$</span>, the transformed model with <span>$(0,1)$</span> coding has coefficients <span>$(2β, 4Λ)$</span>.  The transformed model&#39;s coefficients can be directly compared to logistic regression effect sizes.</p><p>This means there are two ways to compare the symmetric ALR model to a logistic regression model. Either</p><ol><li><p>(recommended) Fit the <span>$(-1,1)$</span> <code>ALRsimple</code> model and transform the parameters, or</p></li><li><p>Fit an <code>ALRsimple</code> model with <code>coding=(0,1)</code> and <code>centering=onehalf</code>.</p></li></ol></div></div><p>Both of the above options are illustrated in the <a href="../Examples/#Comparison-to-logistic-regression">Comparison to logistic regression</a> section of the <a href="../Examples/#Examples">Examples</a> in this manual.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../Design/">Design of the Package »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.14 on <span class="colophon-date" title="Sunday 13 March 2022 08:41">Sunday 13 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
